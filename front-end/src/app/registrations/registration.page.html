<ion-header class="ion-no-border">
  <ion-toolbar color="ideaToolbar" *ngIf="app.isInMobileMode()">
    <ion-buttons slot="start">
      <ion-button (click)="app.closePage()"><ion-icon icon="arrow-back" slot="icon-only"></ion-icon></ion-button>
    </ion-buttons>
    <ion-title>{{ 'EVENT_REGISTRATIONS.REGISTRATION' | translate }}</ion-title>
  </ion-toolbar>
</ion-header>
<ion-content>
  <ion-list class="aList maxWidthContainer" *ngIf="form" [class.viewMode]="!editMode">
    <ion-list-header *ngIf="!app.isInMobileMode()">
      <ion-label>
        <h2>{{ 'EVENT_REGISTRATIONS.REGISTRATION_OF' | translate }}</h2>
      </ion-label>
    </ion-list-header>
    <ion-item>
      <ion-avatar slot="start">
        <ion-img
          [src]="user.avatarURL ?? app.getAvatarFallbackURL()"
          (ionError)="app.fallbackAvatar($event?.target)"
        ></ion-img>
      </ion-avatar>
      <ion-label>
        {{ user.firstName }} {{ user.lastName }}
        <p *ngIf="user.isExternal()"><i>{{ 'PROFILE.EXTERNAL_GUEST' | translate }}</i></p>
        <p *ngIf="!user.isExternal()">{{ user.getSectionCountry() }}</p>
      </ion-label>
      <ion-button
        slot="end"
        fill="clear"
        *ngIf="user.permissions.isAdmin"
        (click)="app.openUserProfileInESNAccounts(user)"
      >
        <ion-icon icon="open-outline" slot="icon-only"></ion-icon>
      </ion-button>
    </ion-item>
    <idea-custom-block
      [sections]="form"
      [blockMeta]="app.configurations.registrationFormDef"
      [errors]="errors"
      [disabled]="!editMode"
    />
    <ion-list-header>
      <ion-label>
        <h2>{{ 'EVENT_REGISTRATIONS.CONFIRM_YOUR_REGISTRATION' | translate }}</h2>
      </ion-label>
    </ion-list-header>
    <ion-item [class.fieldHasError]="hasFieldAnError('tc')">
      <ion-checkbox slot="start" [disabled]="!editMode" [(ngModel)]="acceptTC"></ion-checkbox>
      <ion-label class="ion-text-wrap">
        {{ 'EVENT_REGISTRATIONS.ACCEPT_TC' | translate }} <ion-text class="obligatoryDot"></ion-text>
      </ion-label>
      <ion-button
        slot="end"
        fill="clear"
        color="medium"
        (click)="openDocumentByTranslationKey('EVENT_REGISTRATIONS.TC_URL')"
      >
        <ion-icon slot="icon-only" icon="eye"></ion-icon>
      </ion-button>
    </ion-item>
    <ion-item [class.fieldHasError]="hasFieldAnError('coc')">
      <ion-checkbox slot="start" [disabled]="!editMode" [(ngModel)]="acceptCOC"></ion-checkbox>
      <ion-label class="ion-text-wrap">
        {{ 'EVENT_REGISTRATIONS.ACCEPT_COC' | translate }} <ion-text class="obligatoryDot"></ion-text>
      </ion-label>
      <ion-button
        slot="end"
        fill="clear"
        color="medium"
        (click)="openDocumentByTranslationKey('EVENT_REGISTRATIONS.COC_URL')"
      >
        <ion-icon slot="icon-only" icon="eye"></ion-icon>
      </ion-button>
    </ion-item>
    <ion-row class="ion-margin-top" *ngIf="editMode">
      <ion-col>
        <ion-button expand="block" fill="clear" (click)="save(true)">
          {{ 'EVENT_REGISTRATIONS.SAVE_DRAFT' | translate }}
        </ion-button>
      </ion-col>
      <ion-col>
        <ion-button expand="block" (click)="save()">
          {{ 'EVENT_REGISTRATIONS.SUBMIT_REGISTRATION' | translate }}
        </ion-button>
      </ion-col>
    </ion-row>
  </ion-list>
</ion-content>
